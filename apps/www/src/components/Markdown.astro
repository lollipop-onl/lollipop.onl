---
import { Marked } from 'marked';
import { linkCard, codeBlock, imageWithSize } from 'marked-extensions';
import '@fontsource/ibm-plex-mono';
import 'highlight.js/styles/github.css';

type Props = {
  content: string | undefined;
};
const { content } = Astro.props;

const marked = new Marked({
  breaks: true,
  extensions: [imageWithSize],
  walkTokens(token) {
    // ol の初期値を常に 0 からにする
    if (token.type === 'list') {
      token.start = undefined;
    }
  },
});

marked.use(linkCard, codeBlock);

const html = marked.parse(content ?? '');
---

<script>
  import { LinkCard } from '@components/LinkCard';

  customElements.define('link-card', LinkCard);
</script>

<div set:html={html} />
